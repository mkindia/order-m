{% extends 'base.html' %}

{% block title %} Add Orders {% endblock title %}

{% load static %}
  {% block bodyheader %} 
  {% if sitem == 'None' %} New Order {% endif %}
  {% if sitem != 'None' %} Edit Order {% endif %}
  {% endblock bodyheader %}

{% block content %}
{% if messages %}
<div class="alert alert-success alert-dismissible fade show mt-1" role="alert">
  {% for message in messages %}
  {{message}}
  {% endfor %}
  <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
</div>
{% endif %}

<form class="form" id="test_form" method="POST">
  {% csrf_token %}
  <div class="row g-2">
    {% if sitem == 'None' %}
    <div class="col-sm-6">
      <div class="row g-0">
        <label for="consid">Party</label>
        <div class="col-10">       
        <select id="consid" class="select2" name='party_id' Required=true>
          <option value="" selected>Choose Party...</option>
          {% for party in partys %}
          <option value="{{ party.id }} "> {{ party.party }}</option>
          {% endfor %}
        </select>
        </div>
        <div class="col-2">
        <a class="btn btn-outline-secondary form-control" href="/addparty/order/">+</a>
          </div>
          </div>
    </div>
    <div class="col-sm-6">
      <div class="row g-0">
        <label for="confind">Consignee</label>
       <div class="col-10">        
        <select id="consign" class="select2" name='consignee_id' Required=true>
          <option value="" selected>Choose Consignee...</option>
        </select>
        </div>
        <div class="col-2">
        <a class="btn btn-outline-secondary form-control" href="/addconsignee/order/">+</a>
        </div>
        </div>
    </div>
    {% endif %}
  </div>

  {% if atri == 'edit' %}
   <div class="row g-2 mt-1 m-1">
      <div class="col-sm-6">
        <div class=" input-group input-group">
          <a class="btn btn-outline-secondary" data-bs-toggle="modal" data-bs-target="#additemmodel">add item</a>
          <select class="form-select" name="item_id" id="item_name">
            <option>Select Item</option>
            {% for item in items %}
            {% if item.id == sitem %}
            <option value="{{item.id}}" selected>{{item}}</option>
            {% else %}
            <option value="{{item.id}}">{{item}}</option>
            {% endif %}
            {% endfor %}
          </select>         
        </div>
      </div>
        <div class="col-sm-6">
          <div class=" input-group">
          <span class="input-group-text text-center ">enter des.</span>
          {{orderform.item_des}}
          </div>
        </div>
        <div class="col-sm-6">
          <div class=" input-group">
          <span class="input-group-text text-center ">enter Qty</span>
          {{orderform.qty}}
          </div>
        </div>
        <div class="col-sm-6">
          <div class=" input-group">
          <span class="input-group-text text-center ">select unit</span>
          {{orderform.unit}}
          </div>
        </div>
        <div class="col-sm-6">
        <div class="input-group">
          <span class="input-group-text text-center ">price</span>
           {{orderform.item_price}}
           <span class="input-group-text">/</span>
            {{orderform.per}}
        </div>
        </div>
      </div>
        
    <hr class="mb-1 mt-2">
  </div>
  {% endif %}
  <div class="row g-2 mt-2">
    <div class="col-sm-6">
      <div class="input-group">
        <div class="input-group-prepend">
        <span class="input-group-text text-center ">enter date</span>
        </div>
        {{orderform.orderdate}}
      </div>
    </div>

    <div class="col-sm-6">
      <div class="input-group">
        <div class="input-group-prepend">
        <span class="input-group-text text-center ">enter comment</span>
        </div>
        {{orderform.comment}}
      </div>
    </div>
  </div>

   
      <div class="row g-0 justify-content-end mt-4">
        {% if atri == 'add' %}
     
        <input class="col-sm-6 btn btn-secondary" data-bs-toggle="modal"
          data-bs-target="#additemorder" type="button" id="addorder2" value="Add item order">
        {% endif %}
        {% if atri == 'edit' %}
        <input class="col-sm-6 btn btn-success" {% if atri == 'add' %} type="button" {% else %} type="submit"
          {% endif %} value="Submit" id="saveorders" name="submit_button">
          {% endif %}
      </div>
   
  
 <!-- {% if atri == 'add' %}
  <div class="table-responsive mt-2">
    <table class="table table-sm" id="ordertableid">
      <thead>
        <tr class="text-center">
          <th scope="col">Item</th>
          <th scope="col">Qty.</th>
          <th scope="col">Unit</th>
          <th scope="col">Price</th>
          <th scope="col">Action</th>
        </tr>
      </thead>
      <tbody id="items" class="text-center">

      </tbody>
    </table>
  </div>
  {% endif %} -->
</form>



<div class="modal fade" id="additemorder" data-bs-backdrop="static" aria-labelledby="exampleModalLabel2" aria-hidden="true"
  tabindex="-1">
  <div class="modal-dialog modal-dialog-top">
    <div class="modal-content">
      <div class="modal-header">
        <h6 class="modal-title" id="exampleModalLabel2">Add orders item</h6>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>        
      </div>
      <div class="modal-body">

        <div class="row g-0">
       
            <div class="col-10">
           <!-- <div class="dropdowndiv" >
            
            <input onclick="myFunction()" type="text" readonly value2send="" name="selectedItem" id="showinput" class="searchonclick"
            
             placeholder="Search Item ..."><i class="downaero"> &#9660;</i>
            
             <div id="myDropdown" class="dropdown-content">
              <input type="text" list="items" oninput="onInput()" id="input" class="searchtext" />
              
              <datalist id="items">
                    {% for item in items %}                    
              <option data-value="{{item.id}}" value="{{item.item_name}}"></option>
                {% endfor %}              
              </datalist>
            </div>
           </div> -->
           <select id="select2" class="select2">
            <option hidden selected></option>           
            {% for item in items %}
            <option value={{item.id}}>{{item.item_name}}</option>
            {% endfor %}
          </select>     
            </div>
            <div class="col-2">
              <button class="btn btn-outline-secondary form-control" data-bs-toggle="modal" data-bs-target="#additemmodel">+</button>

            </div>
        
        </div>

        <div class="mt-3">
          <div class=" input-group">
            <div class="input-group-prepend">
              <span class="input-group-text text-center ">item varient</span>
              </div>
            {{orderform.item_des}}
           
          </div>
        </div>
        <div class="mt-3">
          <div class=" input-group">
            <div class="input-group-prepend">
              <span class="input-group-text text-center ">price</span>
              </div>
            {{orderform.item_price}}
            <span class="input-group-text">/</span>
            {{orderform.per}}
          </div>
        </div>

        <div class="mt-3">
          <div class=" input-group input-group ">
            <div class="input-group-prepend">
              <span class="input-group-text text-center ">enter Qty.</span>
              </div>
            {{orderform.qty}}

           
          </div>
        </div>
        <div class="mt-3">
          
          <div class=" input-group input-group ">
            <div class="input-group-prepend">
              <span class="input-group-text text-center ">select unit</span>
              </div>

            {{orderform.unit}}
          </div>
        </div>
          <button type="button" id="addorder" style="width: 100%;height: 40px; border-radius: 8px; margin-top: 35px; background-color: aqua;">Submit</button>
       
      </div>

    </div>
  </div>
</div>

<div class="modal fade bg-light" id="additemmodel" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true"
  tabindex="-1">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Add new item</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form class="form" method="POST">
          {% csrf_token %}
          <div class="row">
          <label>Enter Item name
            <input class="form-control text-capitalize" maxlength="30" id="add_item" type="text" required>
          </div>
          <div class="row g-1 mt-3 justify-content-end">
          <button type="button" id="additem" class="btn btn-primary">Add item</button>
          </div>
        </form>
      </div>
      <div class="modal-footer">
       
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>

      </div>
    </div>
  </div>
</div>

<script>

  $(document).ready(function() {
    $("#select2").select2({
      dropdownParent: $("#additemorder"),
      placeholder: "Select an item ...",     
      width:"100%",
      
    });
  });
  
  </script>
  
{% endblock content %}